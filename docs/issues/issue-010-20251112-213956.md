# Issue #010: Timer Does Not Reset and Start in Challenge Mode

**Date:** 2025-11-12 21:39:56  
**Status:** Fixed  
**Priority:** Medium

## Description

The timer in Challenge Mode was not resetting and starting correctly when:
1. A challenge is started
2. Navigating between questions
3. Submitting answers
4. Skipping or giving up on questions

The timer would continue from a previous value or not start at all, making it difficult to track time spent on each question.

## Root Cause

The timer functions (`startQuestionTimer()`, `stopQuestionTimer()`) were not being called in the challenge mode flow:

1. **`startChallenge()`** - Did not reset or start the timer
2. **`displayChallengeQuestion()`** - Did not reset timer for each new question
3. **`submitChallengeAnswer()`** - Did not stop timer when answer submitted
4. **`skipChallengeQuestion()`** - Did not stop timer when skipping
5. **`giveUpChallengeQuestion()`** - Did not stop timer when giving up
6. **`resetChallenge()`** - Did not stop timer when challenge is reset

## Solution

Added timer reset and start logic to all challenge mode functions:

### Changes Made

1. **`startChallenge()`** - Added timer reset:
   ```javascript
   stopQuestionTimer();
   gameState.questionStartTime = null;
   ```

2. **`displayChallengeQuestion()`** - Added timer reset/start logic:
   ```javascript
   // Reset and start timer for this question (only if not already answered)
   if (questionState !== 'answered' && questionState !== 'gave-up') {
       stopQuestionTimer();
       gameState.questionStartTime = Date.now();
       gameState.questionTimer = setInterval(updateTimer, 100);
   } else {
       // Stop timer if question is already answered
       stopQuestionTimer();
   }
   ```

3. **`submitChallengeAnswer()`** - Added timer stop:
   ```javascript
   // Stop timer when answer is submitted
   stopQuestionTimer();
   ```

4. **`skipChallengeQuestion()`** - Added timer stop:
   ```javascript
   // Stop timer when skipping
   stopQuestionTimer();
   ```

5. **`giveUpChallengeQuestion()`** - Added timer stop:
   ```javascript
   // Stop timer when giving up
   stopQuestionTimer();
   ```

6. **`resetChallenge()`** - Added timer reset:
   ```javascript
   // Stop timer when resetting challenge
   stopQuestionTimer();
   gameState.questionStartTime = null;
   ```

## Testing

Created comprehensive Playwright tests in `tests/ui/challenge-timer.spec.js`:

1. ✅ Timer resets and starts when challenge starts
2. ✅ Timer resets when navigating to next question
3. ✅ Timer stops when answer is submitted
4. ✅ Timer resets when challenge is reset

## Files Modified

- `app.js` - Added timer reset/start logic to challenge mode functions
- `dist/app.js` - Updated build
- `tests/ui/challenge-timer.spec.js` - Created test file

## Verification Steps

1. Start a challenge mode session
2. Verify timer starts at 0s
3. Navigate to next question
4. Verify timer resets to 0s
5. Submit an answer
6. Verify timer stops
7. Exit and restart challenge
8. Verify timer resets to 0s

## Related Issues

None

## Notes

- Timer uses stopwatch format (counting up) in challenge mode
- Timer only runs for unanswered questions
- Timer stops when question is answered, skipped, or given up
- Timer resets when navigating between questions

